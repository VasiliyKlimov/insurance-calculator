<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Калькулятор страхования от клеща</title>
    <style>
        body {
            font-family: sans-serif;
        }
        .container {
            width: 500px;
            margin: 20px auto;
            padding: 20px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        label {
            display: block;
            margin-bottom: 5px;
        }
        input[type="number"],
        select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            box-sizing: border-box;
        }
        .additional-options {
            margin-top: 20px;
            border-top: 1px solid #ddd;
            padding-top: 10px;
        }
        .error {
            color: red;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="container">
        <h2>Калькулятор страхования от клеща</h2>
        <div class="calculator-inputs">
            <h3>Параметры страхования</h3>
            <div>
                <label for="program">Программа страхования:</label>
                <select id="program">
                    <option value="basic">Базовая</option>
                    <option value="complex">Комплексная</option>
                    <option value="complex_ambulance">Комплексная + скорая</option>
                </select>
            </div>
            <div>
                <label for="insuranceDays">Срок страхования (дни):</label>
                <input type="number" id="insuranceDays" value="30" min="1" required>
            </div>
            <div>
                <label for="coverageAmount">Сумма страхового покрытия (₽):</label>
                <input type="number" id="coverageAmount" value="50000" min="1" required>
            </div>
            <div>
                <label for="clientAge">Возраст клиента:</label>
                <input type="number" id="clientAge" min="0" max="120" required>
            </div>
            <div>
                <label for="region">Регион:</label>
                <select id="region" required>
                    <option value="">Выберите регион</option>
                </select>
            </div>

            <div class="additional-options">
                <h3>Дополнительные параметры</h3>
                <div>
                    <label for="occupation">Занятие/хобби:</label>
                    <input type="text" id="occupation">
                </div>
                <div>
                    <label for="healthCondition">Состояние здоровья:</label>
                    <select id="healthCondition">
                        <option value="good">Хорошее</option>
                        <option value="average">Среднее</option>
                        <option value="bad">Плохое</option>
                    </select>
                </div>
                <div>
                    <label for="disabilityCoverage">Сумма компенсации за инвалидность (₽):</label>
                    <input type="number" id="disabilityCoverage" value="0" min="0">
                </div>
                <div>
                    <label for="franchise">Франшиза (₽):</label>
                    <input type="number" id="franchise" value="0" min="0">
                </div>
            </div>
            <button onclick="calculatePremium()">Рассчитать</button>
            <div id="premiumResult">Введите данные и нажмите "Рассчитать".</div>
            <div id="error-message" class="error"></div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
          fetch('regions.json') // Замените на путь к вашему файлу с регионами
            .then(response => response.json())
            .then(regions => {
              const regionSelect = document.getElementById('region');
              regions.forEach(region => {
                const option = document.createElement('option');
                option.value = region.id; // или region.name, в зависимости от структуры JSON
                option.text = region.name;
                regionSelect.appendChild(option);
              });
            }).catch(error => {
              console.error("Ошибка загрузки регионов:", error);
              document.getElementById('error-message').textContent = 'Ошибка загрузки регионов.';
            });
        });

        function calculatePremium() {
            const insuranceDays = Number(document.getElementById('insuranceDays').value);
            const coverageAmount = Number(document.getElementById('coverageAmount').value);
            const clientAge = Number(document.getElementById('clientAge').value);
            const region = document.getElementById('region').value;
            const occupation = document.getElementById('occupation').value;
            const healthCondition = document.getElementById('healthCondition').value;
            const disabilityCoverage = Number(document.getElementById('disabilityCoverage').value);
            const franchise = Number(document.getElementById('franchise').value);
            const program = document.getElementById('program').value;
            const errorMessage = document.getElementById('error-message');
            errorMessage.textContent = "";

            if (Number.isNaN(insuranceDays) || insuranceDays <= 0 || Number.isNaN(coverageAmount) || coverageAmount <= 0 || Number.isNaN(clientAge) || clientAge < 0 || region === "") {
                errorMessage.textContent = 'Пожалуйста, заполните все обязательные поля корректно.';
                return;
            }

            let baseRate = 0.01;

            switch (program) {
                case 'basic':
                    baseRate = 0.01;
                    break;
                case 'complex':
                    baseRate = 0.015;
                    break;
                case 'complex_ambulance':
                    baseRate = 0.02;
                    break;
            }

            let premium = coverageAmount * baseRate * insuranceDays / 365;

            if (healthCondition === 'bad') {
                premium *= 1.2;
            }

            if (disabilityCoverage > 0) {
                premium += disabilityCoverage * 0.005;
            }

            if (franchise > 0) {
                premium -= franchise * 0.001;
            }

            premium = Math.round(premium * 100) / 100;

            document.getElementById('premiumResult').textContent = `Расчётная стоимость страхования: ${premium.toLocaleString('ru-RU')} ₽`;
        }
    </script>

</body>
</html>
